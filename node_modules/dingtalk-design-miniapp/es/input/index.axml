<import-sjs name="classnames" from="./index.sjs"/>

<view
  class="dtm-input 
    {{className}}
    dtm-input-{{type}} 
    {{classnames({
      'dtm-input-multiline': multiline,
      'dtm-input-focus': focus,
      'dtm-input-blur': !focus,
      'disabled': 'dtm-input-disabled',
      'error': errorText || error,
    })}}"
  data-id="{{id}}"
  data-dmId="{{dmId}}"
  style="{{style}}"
  onTap="onItemTap"
>
  <view class="dtm-input-main-content {{classnames({
      'row': !vertical
  })}}">
    <view class="dtm-input-title">
      <view a:if="{{required}}" className="dtm-input-required-icon">*</view>
      {{title}}
    </view>

    <textarea
      a:if="{{type=='multiline'}}"
      placeholderClass="dtm-input-placeholder"
      type="text"
      class="dtm-input-input dtm-input-textarea {{classnames({
        'maxlength': maxlength
      })}}"
      style="opacity:{{valueholder||placeholder||focus?'1':'0;position:absolute;bottom:0;top:0;'}}"
      name="{{name}}"
      value="{{value}}"
      focus="{{focus}}"
      maxlength="{{maxlength}}"
      disabled="{{disabled || readOnly}}"
      auto-height="{{autoHeight}}"
      placeholder="{{placeholder}}"
      onInput="onItemInput"
      onFocus="onItemFocus"
      onBlur="onInputBlur"
      onConfirm="onItemConfirm"
    />

    <view class="dtm-input-inputwrap" a:else>
      <block a:if="{{readOnly}}">
        <view 
          class="dtm-input-input {{!value?'dtm-input-readonly-placeholder':''}}"
          a:if="{{value||placeholder}}" 
          disabled="{{disabled}}"
        >{{value || placeholder}}</view>
        <input className="dtm-hidden-input" type="hidden" name="{{name}}" value="{{value}}" />

        <view class="dtm-input-icon">
          <icon
            a:if="{{rightIconType}}"
            className="right-icon {{rightIconClass}}"
            type="{{rightIconType}}"
            size="{{rightIconSize}}"
          />
        </view>
      </block>
      <block a:else>
        <input 
          placeholderClass="dtm-input-placeholder"
          class="dtm-input-input"
          style="opacity:{{valueholder || placeholder || focus ? '1' : '0;position:absolute;bottom:0;top:0;height:144rpx;'}}" 
          name="{{name}}" 
          password="{{type === 'password' || password }}"
          placeholder="{{placeholder}}" 
          maxlength="{{maxlength}}" 
          type="{{type}}"
          focus="{{focus}}"
          value="{{valueholder||''}}"
          disabled="{{disabled}}"
          onInput="onItemInput"
          onFocus="onItemFocus" 
          onBlur="onInputBlur" 
          onConfirm="onItemConfirm" 
        />

        <view class="dtm-input-icon">
          <icon
            a:if="{{valueholder.length > 0 && autoClear}}"
            className="clear-icon"
            type="icon_eliminate_filled"
            size="32"
            onDmTap="onItemClear"
          />
          <icon
            a:if="{{rightIconType}}"
            className="right-icon {{rightIconClass}}"
            type="{{rightIconType}}"
            size="{{rightIconSize}}"
          />
        </view>
      </block>
    </view>
  </view>
  <view class="dtm-input-error" a:if="{{!!errorText || error}}">{{errorText}}</view>
</view>