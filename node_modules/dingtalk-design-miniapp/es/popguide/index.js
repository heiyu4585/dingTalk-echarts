"use strict";

Component({
  data: {
    $uiName: 'popguide',
    $cssName: 'dtm-popguide'
  },
  props: {
    className: '',
    style: '',
    image: '',
    title: '',
    subtitle: '',
    placement: 'top',
    // top left right bottom topLeft topRight bottomLeft bottomRight
    visible: null,
    // 受控
    defaultVisible: null,
    // 非受控
    onVisibleChange: null
  },
  didMount: function didMount() {
    var _this = this;
    var defaultVisible = this.props.defaultVisible;
    if (defaultVisible !== null) {
      setTimeout(function () {
        _this.setData({
          visible: defaultVisible
        });
      });
    }
  },
  didUpdate: function didUpdate(preProps) {
    var _this2 = this;
    //  防止更新过程中 props 反复传入(导致状态会强制和props一致)
    if (preProps.visible !== this.props.visible) {
      setTimeout(function () {
        _this2.setData({
          visible: _this2.props.visible
        });
      });
    }
  },
  methods: {
    onCloseHook: function onCloseHook() {
      var _this$props = this.props,
        onVisibleChange = _this$props.onVisibleChange,
        defaultVisible = _this$props.defaultVisible;
      if (defaultVisible !== null) {
        this.setData({
          visible: false
        });
      }
      if (onVisibleChange) {
        onVisibleChange(false);
      }
    }
  }
});