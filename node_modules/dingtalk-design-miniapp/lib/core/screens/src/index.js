"use strict";

Component({
  mixins: [],
  data: {
    $uiName: 'screen'
  },
  props: {
    className: '',
    dmId: '',
    item: [],
    autoSelect: true,
    selectList: [],
    style: 'default',
    type: 'checkbox',
    //checkbox 多选，radio 单选---只有在autoSelect生效时有意义
    onDmChange: function onDmChange() {}
  },
  didMount: function didMount() {
    this.setData({
      selectList: this.props.selectList
    });
  },
  didUpdate: function didUpdate(preProps) {
    if (JSON.stringify(this.props.selectList) !== JSON.stringify(preProps.selectList)) {
      this.setData({
        selectList: this.props.selectList
      });
    }
  },
  didUnmount: function didUnmount() {},
  methods: {
    changeState: function changeState(e) {
      var _this = this;
      var _e$target$dataset = e.target.dataset,
        index = _e$target$dataset.index,
        option = _e$target$dataset.option;
      option.index = index;
      if (option.id === undefined) {
        option.id = "screen".concat(this.props.dmId).concat(index);
      }
      if (this.props.autoSelect) {
        if (this.props.type == 'radio') {
          this.setData({
            selectList: [option.id]
          }, function () {
            _this.props.onDmChange(option, _this.data.selectList, _this);
          });
        } else if (this.data.selectList.indexOf(option.id) === -1) {
          this.$spliceData({
            selectList: [0, 0, option.id]
          }, function () {
            _this.props.onDmChange(option, _this.data.selectList, _this);
          });
        } else {
          this.setData({
            selectList: this.data.selectList.filter(function (item) {
              return item != option.id;
            })
          }, function () {
            _this.props.onDmChange(option, _this.data.selectList, _this);
          });
        }
      } else {
        this.props.onDmChange(option, this.data.selectList, this);
      }
    }
  }
});